## Справочник автомобилей: SQLite реализация

### Введение
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;В файл ***initial.py*** вынесен весь код, отвечающий за работу с базой данных. В том числе, DDL скрипты для создания таблиц и триггеров, а также шаблоны запросов.<br/>Тестовый файл базы данных ***database.sqlite*** уже создан и заполнен несколькими записями.<br/><br/>  

### Схема
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;База данных состоит из двух таблиц **cars** и **history**, со связью *один-ко-многим* между ними. Таблица **history** хранит все изменения, происходящие с каждой записью в таблице **cars** – заполняется и очищается автоматически с помощью триггеров.<br/><br/>

### Описание методов API
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Для добавления одного или нескольких автомобилей возможно передать JSON строку. Альтернативой является передача IO объекта, подерживающего метод `.read()`. В качестве фильтров функции `get_cars()` возможно использовать любые поля базы данных. Параметры *`**filters`* проверяются на соответствие словарю.

| Метод | Параметры | Возвращаемый результат |
| :--- | :---: | :---: |
| `get_cars()` <br/> Вывод списка автомобилей | *`**filters`*<br/>Словарь для задания фильтров &#x00B9;<br/><br/>*`_and=True`*<br/>В значении *`True`* – логическое И для фильтров<br/>В значении *`False`* – логическое ИЛИ для фильтров | list of tuples <br/> |
| `add_car()` <br/> Добавление автомобиля(-ей) | *`entry`*<br/>Строка или поддерживающий метод `.read()` объект с данными в формате JSON<br/> | str <br/> |
| `del_car()` <br/> Удаление автомобиля | *`*plate_numbers=None`*<br/>Строка с номером автомобиля для удаления<br/><br/>*`id=None`*<br/>Идентификатор автомобиля | str |
| `get_stats()` <br/> Статистика по базе данных |   –   | JSON str &#x00B2; |

&#x00B9; поля для создания записи об автомобиле: помеченные `'r'` обязательны
```
{
  "plate": 'r',
  "brand": 'r',
  "model": 'r',
  "year": 'r',
  "color": 'r',
  "VIN": '',
  "power": '',
  "body": ''
}
```
&#x00B2; структура JSON вывода функции `get_stats()`:
```
[
  {
    "Total entries": <int>,                         # общее количество всех автомобилей в базе
    "Days of uptime": <str>,                        # дней прошло с первой записи до последнего обновления
    "Last update": <str>,                           # дата и время добавления последней записи
    "Number of cars of different bodies": <dict>,   # количество автомобилей с разным типом кузова
  }
]
```
Все значения времени и даты выводятся в следующем формате: "HH:MM DD.mm.YYYY", например "15:40 03.05.2020"
<br/><br/>

### Примеры
```python_console
>>> car1 = '[{"plate": "e456az", "brand": "Lada", "model": "Kalina", "year": "2013", ' \
...        '"color": "grey", "VIN": "ASDFG8YQ34WIR3","body": "sedan"}]'
>>> add_car(car1)
Success

>>> get_cars(color='black')
[(1, 'a111aa', 'BMW', 'X2', 2000, 'black', 'A0SD89FH0Q734TK', 100.0, 'sport')]

>>> get_cars(color='black', year=2016, _and=False)
[(1, 'a111aa', 'BMW', 'X2', 2000, 'black', 'A0SD89FH0Q734TK', 100.0, 'sport'), (2, 'b123cd', 'Skoda', 'Yeti', 2016, 'olive', 'Q834RLQJRF89FV', 75.0, None)]

>>> del_car("l924jf")
Not found
```
